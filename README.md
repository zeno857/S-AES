# S-AES 加密解密系统用户指南

## 一、系统概述
本系统基于《密码编码学与网络安全 — 原理与实践 (第 8 版)》附录 D 的简化 AES（S-AES）算法实现，提供图形化用户界面（GUI），支持基本加密解密、ASCII 文本加密、多重加密、CBC 工作模式及中间相遇攻击演示，适用于密码学学习与测试场景。

## 二、环境准备

### 1. 运行环境
操作系统：Windows/macOS/Linux  
Python 版本：3.6 及以上

### 2. 依赖库安装
系统依赖以下 Python 库，执行命令完成安装：
```bash
pip install numpy
```
说明：tkinter为 Python 标准库，通常随 Python 安装自带，若缺失需手动安装（如 Ubuntu 执行`sudo apt-get install python3-tk`）。

### 3. 启动系统
1. 将代码保存为.py文件（如SAES_System.py）；
2. 打开终端 / 命令行，切换至文件所在目录；
3. 执行命令启动：`python SAES_System.py`；
4. 启动成功后将自动弹出 GUI 窗口。

## 三、核心功能介绍
系统通过 4 个选项卡组织功能，以下为各模块详细使用说明：

### 1. 基本测试

#### 功能描述
支持 16 位十六进制明文 / 密文的 S-AES 加密与解密，验证基础算法正确性。

#### 操作步骤
1. 在「明文 (16 位)」输入框输入 16 位十六进制数（如1234）；
2. 在「密钥 (16 位)」输入框输入 16 位十六进制数（如AABB）；
3. 点击「加密」按钮，输出框将显示明文、密钥及对应的密文；
4. 点击「解密」按钮（需将输入框改为密文），输出框将显示密文、密钥及对应的明文；
5. 点击「清空」按钮可重置输入与输出内容。

#### 输入要求
- 明文 / 密文：必须为 16 位十六进制数（0-9、A-F/a-f），范围0000~FFFF；
- 密钥：必须为 16 位十六进制数，范围0000~FFFF。

### 2. ASCII 加密

#### 功能描述
支持任意 ASCII 文本的加密与解密，自动将文本按 2 字节（16 位）分组处理。

#### 操作步骤
1. 在「ASCII 文本」输入框输入任意文本（如Hello, S-AES!）；
2. 在「密钥 (16 位)」输入框输入 16 位十六进制密钥；
3. 点击「加密」按钮，输出框将显示原始文本、密钥、加密后的十六进制分组及 ASCII 格式密文；
4. 点击「解密」按钮（需将输入框改为加密后的 ASCII 文本），输出框将显示加密文本、密钥、解密后的十六进制分组及原始文本；
5. 点击「清空」按钮重置内容。

#### 说明
- 加密后的 ASCII 文本可能包含不可打印字符（乱码），建议优先查看十六进制格式结果；
- 文本长度为奇数时，系统自动补全最后一个分组（不影响解密结果）。

### 3. 多重加密

#### 功能描述
支持双重加密（32 位密钥）、三重加密（32 位 / 48 位密钥），并提供中间相遇攻击演示功能。

#### 操作步骤
##### （1）多重加密 / 解密
1. 选择加密类型（单选按钮）：
   - 双重加密 (32 位密钥)：密钥为 32 位十六进制数（00000000~FFFFFFFF）；
   - 三重加密 - 32 位密钥：密钥为 32 位（拆分为 K1、K2，算法为 K1 加密→K2 加密→K1 加密）；
   - 三重加密 - 48 位密钥：密钥为 48 位十六进制数（000000000000~FFFFFFFFFFFF，拆分 K1、K2、K3）；
2. 在「明文」输入框输入 16 位十六进制数；
3. 在「密钥」输入框输入对应长度的十六进制密钥；
4. 点击「加密」或「解密」按钮，输出框显示加密类型、明文 / 密文、密钥拆分及结果；
5. 点击「清空」按钮重置。

##### （2）中间相遇攻击
1. 点击「中间相遇攻击」按钮，弹出攻击窗口；
2. 输入已知明密文对（默认提供演示数据1234/C9A8）；
3. 设置密钥搜索范围（起始 / 结束密钥，建议小范围测试，如1000~1010）；
4. 点击「执行攻击」，结果框将显示中间值表构建过程、候选密钥对及验证结果；
5. 点击「快速演示」可自动填充测试数据，点击「关闭」返回主界面。

### 4. CBC 模式

#### 功能描述
实现 S-AES 的 CBC（密码分组链接）工作模式，支持加密、解密及篡改测试，验证分组密码的链式特性。

#### 操作步骤
##### （1）CBC 加密 / 解密
1. 在「明文 (16 位分组，用空格分隔)」输入框输入多个 16 位十六进制分组（如1234 5678 ABCD）；
2. 在「密钥 (16 位)」输入框输入 16 位十六进制密钥；
3. 在「初始向量 (16 位)」输入框输入 16 位十六进制初始向量（IV）；
4. 点击「CBC 加密」按钮，输出框显示明文分组、密钥、IV 及密文分组；
5. 点击「CBC 解密」按钮（需将输入框改为密文分组），输出框显示密文分组、密钥、IV 及明文分组；
6. 点击「清空」按钮重置。

##### （2）篡改测试
1. 输入明文分组、密钥及 IV（同加密步骤）；
2. 点击「篡改测试」按钮，系统将自动篡改一个密文分组（如修改第二位）；
3. 输出框将显示原始明文、正常密文、篡改密文及解密结果，验证 CBC 模式下篡改的影响范围。

#### 说明
- IV 需为 16 位十六进制数，建议每次加密使用不同 IV 以提高安全性；
- CBC 模式中，篡改一个密文分组将导致对应明文分组及下一个明文分组解密错误。

## 四、注意事项
- 所有输入的十六进制数不区分大小写（如AABB与aabb效果一致）；
- 若输入格式错误（如非十六进制字符、长度不符），系统将弹出错误提示，需修正后重新操作；
- 中间相遇攻击的搜索范围越大，耗时越长，建议小范围测试（如1000~2000）；
- 三重加密的 48 位密钥需严格输入 48 位十六进制数，否则将提示错误；
- 加密后的密文建议以十六进制格式保存，ASCII 格式可能因不可打印字符导致传输或存储异常。

## 五、常见问题
- 启动失败提示 “no module named 'numpy'”？未安装 numpy 库，执行`pip install numpy`即可。
- 输入 16 位数据后提示 “明文和密钥必须是 16 位”？输入长度不足或超过 16 位，需确保为正好 16 位十六进制数（如123需补全为0123）。
- 中间相遇攻击未找到密钥对？可能原因：明密文对不匹配、密钥不在搜索范围内，需检查输入或扩大搜索范围。
- CBC 解密结果与明文不符？需确保密文分组、密钥、IV 与加密时完全一致，任意参数错误将导致解密失败。
